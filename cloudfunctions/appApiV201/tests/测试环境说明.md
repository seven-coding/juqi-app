# 测试环境说明

## 测试运行要求

### 1. 云开发环境配置

测试需要在**微信云开发环境**中运行，需要以下配置：

1. **环境ID**: `test-juqi-3g1m5qa7cc2737a1`
2. **云函数**: `appApi` 必须已部署
3. **腾讯云密钥**: 需要配置 `secretId` 和 `secretKey`

### 2. 错误说明

如果看到以下错误：

```
callFunction:fail missing secretId or secretKey of tencent cloud
```

**原因**: 当前运行环境没有配置腾讯云密钥，无法调用云函数。

**解决方法**:
1. 在微信开发者工具中运行测试
2. 或者在已配置云开发环境的服务器上运行
3. 或者配置本地云开发环境

### 3. 运行方式

#### 方式1: 在微信开发者工具中运行

1. 打开微信开发者工具
2. 打开项目 `JUQI-APP`
3. 在终端中运行：
   ```bash
   cd cloudfunctions/appApi
   node tests/run-all-tests.js
   ```

#### 方式2: 在云开发环境中运行

1. 确保已配置云开发环境
2. 确保已部署 `appApi` 云函数
3. 运行测试：
   ```bash
   cd cloudfunctions/appApi
   node tests/run-all-tests.js
   ```

### 4. 测试结果解读

#### 成功情况

- 所有测试通过
- 通过率 100%
- 无错误信息

#### 环境配置问题

- 错误: `missing secretId or secretKey`
- **说明**: 这是环境配置问题，不是测试代码问题
- **解决**: 在正确的环境中运行

#### 业务逻辑问题

- 测试失败但错误信息不是环境配置问题
- **说明**: 可能是业务逻辑或数据格式问题
- **解决**: 根据错误信息修复代码

---

## 测试框架验证

即使无法在真实环境中运行，测试框架本身已经验证：

✅ **语法检查**: 所有测试文件语法正确
✅ **文件结构**: 所有测试文件已创建
✅ **测试逻辑**: 测试用例逻辑完整
✅ **错误处理**: 测试框架能正确处理错误

---

## 下一步

1. **在正确的环境中运行测试**
   - 使用微信开发者工具
   - 或配置云开发环境

2. **查看测试结果**
   - 检查通过率
   - 查看失败用例
   - 修复发现的问题

3. **持续集成**
   - 将测试集成到CI/CD流程
   - 每次代码提交自动运行测试

---

**文档创建时间**: 2026-01-15

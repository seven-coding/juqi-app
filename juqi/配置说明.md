# 微信登录配置说明

## 已完成的配置

✅ Podfile 已添加 WechatOpenSDK 依赖
✅ Info.plist 已配置 LSApplicationQueriesSchemes 和 URL Types
✅ AppDelegate 已创建并配置微信回调处理
✅ LoginView 已更新为使用真实微信 SDK

## 需要手动配置的内容

### 1. 替换微信 AppID

#### 在 AppDelegate.swift 中：
找到第 13 行，将 `YOUR_WECHAT_APP_ID` 替换为你的真实微信 AppID：
```swift
private let wechatAppID = "你的微信AppID"
```

#### 在 Info.plist 中：
找到第 18 行，将 `wxYOUR_APP_ID` 替换为你的真实微信 AppID（格式：`wx` + AppID）：
```xml
<string>wx你的微信AppID</string>
```

### 2. 配置 Universal Links

在 AppDelegate.swift 第 18 行，将 Universal Link 替换为你的域名：
```swift
WXApi.registerApp(wechatAppID, universalLink: "https://your-domain.com/wechat/")
```

**注意**：
- Universal Link 需要在微信开放平台配置
- 格式：`https://your-domain.com/wechat/`
- 需要在服务器上配置对应的路径和文件

### 3. 在 Xcode 中配置 URL Scheme

1. 打开 Xcode 项目
2. 选择项目 Target
3. 选择 `Info` 标签页
4. 展开 `URL Types`
5. 如果已有 URL Type，检查 URL Schemes 是否为 `wx你的AppID`
6. 如果没有，点击 `+` 添加：
   - **Identifier**: `weixin`
   - **URL Schemes**: `wx你的微信AppID`

### 4. 确保 Info.plist 被包含在项目中

1. 在 Xcode 中，右键点击项目
2. 选择 `Add Files to "juqi"...`
3. 选择 `Info.plist` 文件
4. 确保勾选 `Copy items if needed` 和 `Add to targets: juqi`

### 5. 在 Build Settings 中配置 Info.plist

1. 选择项目 Target
2. 选择 `Build Settings`
3. 搜索 `Info.plist File`
4. 确保路径为：`juqi/Info.plist`

## 测试步骤

1. **在真机上测试**（模拟器无法调用微信）
2. 确保已安装微信客户端
3. 点击"微信授权登录"按钮
4. 应该会跳转到微信进行授权
5. 授权成功后返回 App，应该自动完成登录

## 常见问题

### 问题1：点击登录按钮没有反应
- 检查微信是否已安装
- 检查 AppID 是否正确配置
- 检查 URL Scheme 是否正确配置

### 问题2：授权后无法返回 App
- 检查 URL Scheme 配置
- 检查 Info.plist 中的 URL Types
- 检查 AppDelegate 中的回调处理

### 问题3：提示"微信版本不支持"
- 更新微信到最新版本
- 检查 WechatOpenSDK 版本是否过旧

## 微信开放平台配置

1. 登录 [微信开放平台](https://open.weixin.qq.com/)
2. 创建移动应用
3. 获取 AppID 和 AppSecret
4. 配置 Bundle ID（必须与 Xcode 项目中的 Bundle Identifier 一致）
5. 配置 Universal Links：
   - 在"开发信息"中配置 Universal Links
   - 格式：`https://your-domain.com/wechat/`
   - 需要在服务器上放置 `apple-app-site-association` 文件

## 注意事项

⚠️ **重要**：
- AppSecret 不要存储在客户端，应该在后端使用
- Universal Links 需要 HTTPS 域名
- 测试时需要在真机上进行
- 提交 App Store 审核前确保功能正常

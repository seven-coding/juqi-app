# 解决 apple-app-site-association 404 问题

## ✅ 文件已部署

文件已成功上传到静态网站托管：
- **文件路径**: `.well-known/apple-app-site-association`
- **默认域名访问**: https://prod-juqi-7glu2m8qfa31e13f-1314478640.tcloudbaseapp.com/.well-known/apple-app-site-association
- **自定义域名访问**: https://juqi.life/.well-known/apple-app-site-association

## 🔍 404 问题的可能原因

### 1. CDN 缓存未刷新（最常见）

静态网站托管使用 CDN 加速，文件上传后可能需要几分钟才能通过自定义域名访问。

**解决方案**：
- 等待 5-10 分钟让 CDN 缓存刷新
- 或者清除浏览器缓存后重试
- 可以在 URL 后加随机参数测试：`https://juqi.life/.well-known/apple-app-site-association?v=123`

### 2. 自定义域名未正确关联静态网站托管

虽然域名配置显示"正常"，但需要确认自定义域名是否关联到了静态网站托管。

**检查方法**：
1. 访问云开发控制台：https://tcb.cloud.tencent.com/dev?envId=prod-juqi-7glu2m8qfa31e13f#/static-hosting
2. 查看"自定义域名"配置
3. 确认 `juqi.life` 是否关联到静态网站托管

### 3. DNS 解析未完全生效

虽然域名状态显示正常，但 DNS 解析可能需要一些时间。

**验证方法**：
```bash
# 在终端执行
nslookup juqi.life
# 或
dig juqi.life
```

应该能看到 CNAME 记录指向：`juqi.life.cdn.dnsv1.com`

## 🚀 立即验证

### 方法一：通过默认域名验证

先访问默认域名，确认文件确实存在：
```
https://prod-juqi-7glu2m8qfa31e13f-1314478640.tcloudbaseapp.com/.well-known/apple-app-site-association
```

如果这个可以访问，说明文件部署成功，只是自定义域名的 CDN 缓存问题。

### 方法二：清除 CDN 缓存

如果文件已部署但自定义域名仍无法访问：

1. 访问云开发控制台
2. 进入"静态网站托管"
3. 找到"CDN 缓存刷新"或"清除缓存"功能
4. 清除 `.well-known/apple-app-site-association` 的缓存

### 方法三：等待缓存自动刷新

CDN 缓存通常会在 5-10 分钟内自动刷新。可以：
- 等待几分钟后重试
- 使用无痕模式访问
- 在 URL 后加时间戳参数：`?t=1234567890`

## 📝 验证步骤

1. **验证默认域名**（应该可以访问）：
   ```
   https://prod-juqi-7glu2m8qfa31e13f-1314478640.tcloudbaseapp.com/.well-known/apple-app-site-association
   ```

2. **验证自定义域名**（可能需要等待）：
   ```
   https://juqi.life/.well-known/apple-app-site-association
   ```

3. **验证文件内容**：
   应该看到 JSON 内容：
   ```json
   {
     "applinks": {
       "apps": [],
       "details": [
         {
           "appID": "CRP77P4D8P.com.seven.juqi",
           "paths": [
             "/app/*"
           ]
         }
       ]
     }
   }
   ```

## ⚠️ 重要提示

1. **Content-Type 问题**：如果返回 404 或内容不正确，可能需要确保文件的 Content-Type 是 `application/json` 或 `text/plain`
2. **文件必须无扩展名**：文件名必须是 `apple-app-site-association`（不能是 `.json`）
3. **路径必须正确**：必须在 `.well-known/` 目录下

## 🔗 相关链接

- **静态网站托管控制台**: https://tcb.cloud.tencent.com/dev?envId=prod-juqi-7glu2m8qfa31e13f#/static-hosting
- **默认域名访问**: https://prod-juqi-7glu2m8qfa31e13f-1314478640.tcloudbaseapp.com/.well-known/apple-app-site-association
- **自定义域名访问**: https://juqi.life/.well-known/apple-app-site-association
